<!DOCTYPE HTML>
<html lang="en">

<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Ryan&#39;s blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->

<meta name="keywords" content="" />


<meta name="description" content="Machine Learning Driven Real-time Predicted Online Shopper Intension Model123456import pandas as ..." />


<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->

<title>
    
    Project-Summary |
    
    Ryan&#39;s blog
</title>

<link rel="alternate" href="/atom.xml" title="Ryan&#39;s blog" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    

<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">
    
<div class="hide">
    <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</div>




    

</head>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header"  style="background-image:url(
    http://snippet.shenliyang.com/img/banner.jpg)"
     >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='Ryan'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            
            
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://yoursite.com">
                        Ryan&#39;s blog</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa "></i>
                                Home</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa "></i>
                                Archives</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="Project-Summary">
            
            Project-Summary
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2019/10/28</span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="Machine-Learning-Driven-Real-time-Predicted-Online-Shopper-Intension-Model"><a href="#Machine-Learning-Driven-Real-time-Predicted-Online-Shopper-Intension-Model" class="headerlink" title="Machine Learning Driven Real-time Predicted Online Shopper Intension Model"></a>Machine Learning Driven Real-time Predicted Online Shopper Intension Model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns <span class="comment"># data visualization</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm, linear_model</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">(path)</span>:</span></span><br><span class="line">    path =  <span class="string">'c:\\project\\Online_Retail.csv'</span></span><br><span class="line">    data = pd.read_csv(path, skiprows=<span class="number">1</span>, names=[<span class="string">'InvoiceNo'</span>, <span class="string">'StockCode'</span>,<span class="string">'Description'</span>, <span class="string">'Quantity'</span>, <span class="string">'InvoiceDate'</span>,</span><br><span class="line">                                                <span class="string">'UnitPrice'</span>, <span class="string">'CustomerID'</span>, <span class="string">'Country'</span>], delimiter=<span class="string">';'</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">raw_data = load_data(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">print</span> (raw_data.describe())</span><br></pre></td></tr></table></figure>

<pre><code>            Quantity      UnitPrice     CustomerID
count  541909.000000  541909.000000  406829.000000
mean        9.552250       4.611114   15287.690570
std       218.081158      96.759853    1713.600303
min    -80995.000000  -11062.060000   12346.000000
25%         1.000000       1.250000   13953.000000
50%         3.000000       2.080000   15152.000000
75%        10.000000       4.130000   16791.000000
max     80995.000000   38970.000000   18287.000000</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> np.asarray(raw_data[<span class="string">'InvoiceNo'</span>])</span><br><span class="line"><span class="keyword">print</span> raw_data[<span class="string">'Country'</span>]</span><br></pre></td></tr></table></figure>

<pre><code>[&apos;536365&apos; &apos;536365&apos; &apos;536365&apos; ... &apos;581587&apos; &apos;581587&apos; &apos;581587&apos;]
0         United Kingdom
1         United Kingdom
2         United Kingdom
3         United Kingdom
4         United Kingdom
5         United Kingdom
6         United Kingdom
7         United Kingdom
8         United Kingdom
9         United Kingdom
10        United Kingdom
11        United Kingdom
12        United Kingdom
13        United Kingdom
14        United Kingdom
15        United Kingdom
16        United Kingdom
17        United Kingdom
18        United Kingdom
19        United Kingdom
20        United Kingdom
21        United Kingdom
22        United Kingdom
23        United Kingdom
24        United Kingdom
25        United Kingdom
26                France
27                France
28                France
29                France
               ...      
541879    United Kingdom
541880    United Kingdom
541881    United Kingdom
541882    United Kingdom
541883    United Kingdom
541884    United Kingdom
541885    United Kingdom
541886    United Kingdom
541887    United Kingdom
541888    United Kingdom
541889    United Kingdom
541890    United Kingdom
541891    United Kingdom
541892    United Kingdom
541893    United Kingdom
541894            France
541895            France
541896            France
541897            France
541898            France
541899            France
541900            France
541901            France
541902            France
541903            France
541904            France
541905            France
541906            France
541907            France
541908            France
Name: Country, Length: 541909, dtype: object</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">p = sns.countplot(data = raw_data, x = <span class="string">'Country'</span>)</span><br></pre></td></tr></table></figure>


<p><img src="/2019/10/28/Project-Summary/1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> (raw_data[<span class="string">'Country'</span>].unique())</span><br></pre></td></tr></table></figure>

<pre><code>[&apos;United Kingdom&apos; &apos;France&apos; &apos;Australia&apos; &apos;Netherlands&apos; &apos;Germany&apos; &apos;Norway&apos;
 &apos;EIRE&apos; &apos;Switzerland&apos; &apos;Spain&apos; &apos;Poland&apos; &apos;Portugal&apos; &apos;Italy&apos; &apos;Belgium&apos;
 &apos;Lithuania&apos; &apos;Japan&apos; &apos;Iceland&apos; &apos;Channel Islands&apos; &apos;Denmark&apos; &apos;Cyprus&apos;
 &apos;Sweden&apos; &apos;Austria&apos; &apos;Israel&apos; &apos;Finland&apos; &apos;Bahrain&apos; &apos;Greece&apos; &apos;Hong Kong&apos;
 &apos;Singapore&apos; &apos;Lebanon&apos; &apos;United Arab Emirates&apos; &apos;Saudi Arabia&apos;
 &apos;Czech Republic&apos; &apos;Canada&apos; &apos;Unspecified&apos; &apos;Brazil&apos; &apos;USA&apos;
 &apos;European Community&apos; &apos;Malta&apos; &apos;RSA&apos;]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">country_list = raw_data[<span class="string">'Country'</span>].unique()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(country_list)):</span><br><span class="line">    raw_data.loc[raw_data[<span class="string">'Country'</span>] == country_list[i], [<span class="string">'Country'</span>]]  = i + <span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> raw_data[<span class="string">'Country'</span>]</span><br></pre></td></tr></table></figure>

<pre><code>0         1
1         1
2         1
3         1
4         1
5         1
6         1
7         1
8         1
9         1
10        1
11        1
12        1
13        1
14        1
15        1
16        1
17        1
18        1
19        1
20        1
21        1
22        1
23        1
24        1
25        1
26        2
27        2
28        2
29        2
         ..
541879    1
541880    1
541881    1
541882    1
541883    1
541884    1
541885    1
541886    1
541887    1
541888    1
541889    1
541890    1
541891    1
541892    1
541893    1
541894    2
541895    2
541896    2
541897    2
541898    2
541899    2
541900    2
541901    2
541902    2
541903    2
541904    2
541905    2
541906    2
541907    2
541908    2
Name: Country, Length: 541909, dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">description_length_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(raw_data[<span class="string">'Description'</span>])):</span><br><span class="line">     description_length_list.append(len(str(raw_data[<span class="string">'Description'</span>][i])))</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stock_code_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(raw_data[<span class="string">'StockCode'</span>])):</span><br><span class="line">    stock_code_list.append(len(str(raw_data[<span class="string">'StockCode'</span>][i])))</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> raw_data[<span class="string">'InvoiceDate'</span>]</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">time1 = <span class="string">'2010/12/1 8:26'</span></span><br><span class="line">time2 = <span class="string">'2010/12/1 8:34'</span></span><br><span class="line"><span class="keyword">print</span> datetime.strptime( time1,  <span class="string">"%Y/%m/%d %H:%M"</span>) &gt; datetime.strptime( time2,  <span class="string">"%Y/%m/%d %H:%M"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>0          2010/12/1 8:26
1          2010/12/1 8:26
2          2010/12/1 8:26
3          2010/12/1 8:26
4          2010/12/1 8:26
5          2010/12/1 8:26
6          2010/12/1 8:26
7          2010/12/1 8:28
8          2010/12/1 8:28
9          2010/12/1 8:34
10         2010/12/1 8:34
11         2010/12/1 8:34
12         2010/12/1 8:34
13         2010/12/1 8:34
14         2010/12/1 8:34
15         2010/12/1 8:34
16         2010/12/1 8:34
17         2010/12/1 8:34
18         2010/12/1 8:34
19         2010/12/1 8:34
20         2010/12/1 8:34
21         2010/12/1 8:34
22         2010/12/1 8:34
23         2010/12/1 8:34
24         2010/12/1 8:34
25         2010/12/1 8:35
26         2010/12/1 8:45
27         2010/12/1 8:45
28         2010/12/1 8:45
29         2010/12/1 8:45
               ...       
541879    2011/12/9 12:31
541880    2011/12/9 12:31
541881    2011/12/9 12:31
541882    2011/12/9 12:31
541883    2011/12/9 12:31
541884    2011/12/9 12:31
541885    2011/12/9 12:31
541886    2011/12/9 12:31
541887    2011/12/9 12:31
541888    2011/12/9 12:31
541889    2011/12/9 12:31
541890    2011/12/9 12:49
541891    2011/12/9 12:49
541892    2011/12/9 12:49
541893    2011/12/9 12:49
541894    2011/12/9 12:50
541895    2011/12/9 12:50
541896    2011/12/9 12:50
541897    2011/12/9 12:50
541898    2011/12/9 12:50
541899    2011/12/9 12:50
541900    2011/12/9 12:50
541901    2011/12/9 12:50
541902    2011/12/9 12:50
541903    2011/12/9 12:50
541904    2011/12/9 12:50
541905    2011/12/9 12:50
541906    2011/12/9 12:50
541907    2011/12/9 12:50
541908    2011/12/9 12:50
Name: InvoiceDate, Length: 541909, dtype: object
False</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">InvoiceDate_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(raw_data[<span class="string">'InvoiceDate'</span>])):</span><br><span class="line">    InvoiceDate_list.append(datetime.strptime( raw_data[<span class="string">'InvoiceDate'</span>][i],  <span class="string">"%Y/%m/%d %H:%M"</span>))</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_seconds</span><span class="params">(date)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> *date.day + <span class="number">60</span> * <span class="number">60</span> *date.hour + <span class="number">60</span> * date.minute + date.second</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(InvoiceDate_list)):</span><br><span class="line">    InvoiceDate_list[i] =  to_seconds(InvoiceDate_list[i])</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">InvoiceNo_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(raw_data[<span class="string">'InvoiceNo'</span>])):</span><br><span class="line">    <span class="keyword">if</span> len(raw_data[<span class="string">'InvoiceNo'</span>][i]) &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="comment">#print raw_data['InvoiceNo'][i][1:5]</span></span><br><span class="line">        InvoiceNo_list.append(int(raw_data[<span class="string">'InvoiceNo'</span>][i][<span class="number">1</span>:<span class="number">5</span>]))</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">all_data = []  </span><br><span class="line">names=[<span class="string">'InvoiceNo'</span>, <span class="string">'StockCode'</span>,<span class="string">'Quantity'</span>, <span class="string">'InvoiceDate'</span>,</span><br><span class="line">                                                <span class="string">'UnitPrice'</span>, <span class="string">'CustomerID'</span>, <span class="string">'Country'</span>]</span><br><span class="line">all_data.append(InvoiceNo_list)</span><br><span class="line">all_data.append(stock_code_list)</span><br><span class="line"></span><br><span class="line">all_data.append(InvoiceDate_list)</span><br><span class="line">all_data.append(raw_data[<span class="string">'UnitPrice'</span>].tolist())</span><br><span class="line">all_data.append(raw_data[<span class="string">'CustomerID'</span>].tolist())</span><br><span class="line">all_data.append(raw_data[<span class="string">'Country'</span>].tolist())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(all_data)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(all_data[i])):</span><br><span class="line">        all_data[i][j] = float(all_data[i][j])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target_data = []</span><br><span class="line">target_data.append(raw_data[<span class="string">'Quantity'</span>].tolist())</span><br><span class="line"><span class="keyword">print</span> len(target_data)</span><br></pre></td></tr></table></figure>

<pre><code>1</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">all_data = np.asarray(all_data)</span><br><span class="line"><span class="keyword">print</span> all_data.shape</span><br><span class="line">target_data = np.asarray(target_data)</span><br><span class="line"><span class="keyword">print</span> target_data.shape</span><br><span class="line">target_data = np.transpose(target_data)</span><br><span class="line">all_data = np.transpose(all_data)</span><br><span class="line"><span class="keyword">print</span> target_data.shape</span><br><span class="line">all_data = pd.DataFrame(all_data)</span><br><span class="line">all_data = all_data.fillna(all_data.mean())</span><br><span class="line">target_data = pd.DataFrame(target_data)</span><br><span class="line">target_data = all_data.fillna(target_data.mean())</span><br><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(all_data, target_data, test_size = <span class="number">0.33</span>, random_state = <span class="number">42</span>)</span><br><span class="line">X_train = all_data[<span class="number">0</span>:<span class="number">363079</span>][:]</span><br><span class="line">X_test = all_data[<span class="number">363079</span>: len(all_data)][:]</span><br><span class="line">Y_train = target_data[<span class="number">0</span>:<span class="number">363079</span>][:]</span><br><span class="line">Y_test = target_data[<span class="number">363079</span>: len(all_data)][:]</span><br><span class="line"><span class="keyword">print</span> X_train.shape</span><br></pre></td></tr></table></figure>

<pre><code>(541909L, 6L)
(541909L, 1L)
(1L, 541909L)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">X_train = pd.DataFrame(X_train)</span><br><span class="line">Y_train = pd.DataFrame(Y_train)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> X_train.isnull().values.any()</span><br><span class="line"></span><br><span class="line">X_train = X_train.fillna(X_train.mean())</span><br><span class="line"><span class="keyword">print</span> Y_train.isnull().values.any()</span><br></pre></td></tr></table></figure>

<pre><code>False
False</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ridge regression </span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Ridge</span><br><span class="line"><span class="comment"># initialize ridge regression model </span></span><br><span class="line">ridge_model = Ridge(alpha = <span class="number">0.5</span>)</span><br><span class="line">ridge_model.fit(X_train, Y_train) <span class="comment"># training the model</span></span><br></pre></td></tr></table></figure>




<pre><code>Ridge(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=None,
   normalize=False, random_state=None, solver=&apos;auto&apos;, tol=0.001)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X_test = pd.DataFrame(X_test)</span><br><span class="line">X_test = X_test.fillna(X_test.mean())</span><br><span class="line">ridge_predict = ridge_model.predict(X_test)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ridge_predict)):</span><br><span class="line">    ridge_predict[i][<span class="number">0</span>]= int(ridge_predict[i][<span class="number">0</span>])</span><br></pre></td></tr></table></figure>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> ridge_predict</span><br></pre></td></tr></table></figure>

<pre><code>[[10.]
 [10.]
 [10.]
 ...
 [12.]
 [12.]
 [12.]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Lasso</span><br><span class="line">Lasso_model = Lasso(alpha = <span class="number">0.5</span>)</span><br><span class="line">Lasso_model.fit(X_train, Y_train)</span><br></pre></td></tr></table></figure>




<pre><code>Lasso(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=1000,
   normalize=False, positive=False, precompute=False, random_state=None,
   selection=&apos;cyclic&apos;, tol=0.0001, warm_start=False)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Lasso_predict = Lasso_model.predict(X_test)</span><br><span class="line"><span class="keyword">print</span> Lasso_predict</span><br></pre></td></tr></table></figure>

<pre><code>[10.4250943  10.4255967  10.40173248 ... 11.69419001 11.69419001
 11.69218039]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(Lasso_predict)):</span><br><span class="line">    Lasso_predict[i]=int(round(Lasso_predict[i]))</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> BayesianRidge</span><br><span class="line">bayesian_model = BayesianRidge(fit_intercept = <span class="literal">True</span>, normalize = <span class="literal">False</span>)</span><br><span class="line">bayesian_model.fit(X_train,Y_train)</span><br></pre></td></tr></table></figure>

<pre><code>BayesianRidge(alpha_1=1e-06, alpha_2=1e-06, compute_score=False, copy_X=True,
       fit_intercept=True, lambda_1=1e-06, lambda_2=1e-06, n_iter=300,
       normalize=False, tol=0.001, verbose=False)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bayesian_predict = bayesian_model.predict(X_test)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(bayesian_predict)):</span><br><span class="line">    bayesian_predict[i] = int(round(bayesian_predict[i]))</span><br></pre></td></tr></table></figure>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neural_network <span class="keyword">import</span> MLPRegressor</span><br><span class="line">nn_model = MLPRegressor(hidden_layer_sizes = (<span class="number">100</span>,<span class="number">50</span>,), activation = <span class="string">'relu'</span>, solver = <span class="string">'sgd'</span>)</span><br><span class="line">nn_model.fit(X_train,Y_train)</span><br><span class="line">nn_predict = nn_model.predict(X_test)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line">plt.hold()</span><br><span class="line">plt.plot(ridge_predict[:, <span class="number">0</span>], color = <span class="string">'r'</span>)</span><br><span class="line">plt.plot(Y__test[:,<span class="number">0</span>], color = <span class="string">'b'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/28/Project-Summary/2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for ridge: '</span>, mean_absolute_error(Y_test,ridge_predict)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for lasso: '</span>, mean_absolute_error(Y_test,Lasso_predict)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for bayesian: '</span>, mean_absolute_error(Y_test,bayesian_predict)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for NN: '</span>, mean_absolute_error(Y_test,nn_predict)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'mean square error for ridge: '</span>, mean_square_error(Y_test,ridge_predict)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for lasso: '</span>, mean_absolute_error(Y_test,Lasso_predict)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for bayesian: '</span>, mean_absolute_error(Y_test,bayessian_predict)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'mean absolute error for NN: '</span>, mean_absolute_error(Y_test,nn_predict)</span><br></pre></td></tr></table></figure>





<p><img src="/2019/10/28/Project-Summary/3.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fig.ax1 = plt.subplots()</span><br><span class="line">ax1.plot(ridge_predict)</span><br><span class="line">ax1.set_title(<span class="string">"rifge regression prediction result"</span>)</span><br><span class="line">fig.ax2 = plt.subplots()</span><br><span class="line">ax2.plot(Lasso_predict)</span><br><span class="line">ax2.set_title(<span class="string">"rifge regression prediction result"</span>)</span><br><span class="line">fig.ax3 = plt.subplots()</span><br><span class="line">ax3.plot(Y_test[:,<span class="number">0</span>])</span><br><span class="line">ax3.set_title(<span class="string">"rifge regression prediction result"</span>)</span><br></pre></td></tr></table></figure>


<p>The purpose of my plan is to estimate the actual situation of data by collecting, collating and analyzing data and mathematical models. In the project, I first imported the data I needed from an excel file into the jupyter notebook.The data is then standardized and converted from a unified text classification to a numerical classification such as 1, 2, and 3 to make the program understandable.Then all the processed data atmosphere experimental group and test group, so the data preprocessing is completed.Then build the model using the test and train commands and train the model with data.Then sklearn and pandas functions will be used to compare the estimated data of the model with the real data, and adjust the parameters of the model to get the final model.</p>
<p>The biggest difficulty in this project was the lack of familiarity with python.The computer language I learned before was not python, but in this project, I need to use python to complete the data translation and program training.At the same time, the difficulty of this course also caused some trouble to me. For me, the knowledge of artificial intelligence and some functions are the difficulties of this course.In order to make up for my unfamiliarity with this part of knowledge, I need to watch a video teaching on python by myself and get familiar with some syntax and tools of python.</p>
<p>What attracts me most about this activity is that it is the time to estimate the result of the data after building the play model.When I finished a lot of preparation work and adjustments, I felt very happy and novel to see the final image display results.<br>After finally training the model, I used the model to predict the desired results.The predicted results were compared with the actual results of the test group.Finally, adjust the parameters of the model to find the most accurate model.</p>
<p>Through this project, I first learned a lot of python related knowledge such as sklearn function, append command and so on.More importantly, I understand what machine learning means.This is a technology that studies how computers simulate or implement human learning behavior in order to acquire new knowledge or skills and reorganize the existing knowledge structure so that it can continuously improve its own performance.In particular, I learned a lot about how to train computer programs.</p>

    </div>
    
    <div class="post-footer">
        <div>
            
            ：
            
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    <a href="/2019/10/28/About-Me/" class="pre-post btn btn-default" title='About-Me'>
        <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
        <span class="hidden-xs">
            About-Me</span>
    </a>
    
    
</div>

<div id="comments">
    
    

</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            Table of Contents
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Machine-Learning-Driven-Real-time-Predicted-Online-Shopper-Intension-Model"><span class="toc-text">Machine Learning Driven Real-time Predicted Online Shopper Intension Model</span></a></li></ol>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2019
                    
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



<script src="/js/app.js?rev=@@hash"></script>
</body>
</html>